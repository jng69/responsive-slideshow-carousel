<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Vanilla js carousel</title>
  <!-- <link rel="stylesheet" href="./style.css"> -->
  <style>
    *,
*:before,
*:after {
  box-sizing: border-box;
}

.carousel {
  position: relative;
  width: 90%;
  height: 90px; 
  margin: 0 auto;
}

.carousel-content {
  position: relative;
  overflow: hidden;
  transition: width .4s;
  height: 200px;
}

.slide {
  height: 100%;
  width: 100%;
  background-color: black;
  position: absolute;
  z-index: 1;
  transition: left .4s cubic-bezier(.47,.13,.15,.89);
  color: aliceblue;
  padding: 3%;
  text-align: center;
  text-shadow: 0px 0px 9px rgba(0,0,0,0.8);
}

.slide-1 {
  background-color: black;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2014/11/08164934/Landscape-Photography-steps.jpg') center;
  background-size: cover;
}

.slide-2 {
  background-color: green;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26171710/bean-field.jpg') center;
  background-size: cover;
}

.slide-3 {
  background-color: red;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26171343/shallow-depth-of-field.jpg') center;
  background-size: cover;
}

.slide-4 {
  background-color: purple;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26173419/landscape-horizon.jpg') center;
  background-size: cover;
}

.slide-5 {
  background-color: darkorchid;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26170440/long-exposure.jpg') center;
  background-size: cover;
}

.slide-6 {
  background-color: blue;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26170253/golden-hour-image-of-field-and-sky.jpg') center;
  background-size: cover;
}

.slide-7 {
  background-color: violet;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26170023/mountains-black-and-white.jpg') center;
  background-size: cover;
}

.slide-8 {
  background-color: indigo;
  background: transparent url('https://media.photographycourse.net/wp-content/uploads/2023/05/26153539/tack-sharp-landscape-photo.jpg') center;
  background-size: cover;
}

.nav {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  background-color: rgba(150,150,150,.3);
  width: 20px;
  height: 20px;
  z-index: 2;
  cursor: pointer;
  border-radius: 50%;
  border: none;
  outline: none;
  color: white;
  -webkit-user-select: none;
}

.nav-left {
  left: -25px;
}

.nav-right {
  right: -25px;
}

.carousel-arrow-icon-left {
  margin-left: 5px;
  margin-top: 2px;
}

.carousel-arrow-icon-right {
  margin-left: 7px;
  margin-top: 2px;
}

.hd {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
  </style>
</head>
<body>
<div class="container">

<div class="carousel">
      <div class="nav nav-left">
        <div class="ion-chevron-left carousel-arrow-icon-left"></div>
      </div>

        <div class="carousel-content">
          
          <div class="slide slide-1">
            <div class="hd">ONE</div>
          </div>
          <div class="slide slide-2">
            <div class="hd">TWO</div>
          </div>
          <div class="slide slide-3">
            <div class="hd">THREE</div>
          </div>
          <div class="slide slide-4">
            <div class="hd">FOUR</div>
          </div>
          <div class="slide slide-5">
            <div class="hd">FIVE</div>
          </div>
          <div class="slide slide-6">
            <div class="hd">SIX</div>
          </div>
          <div class="slide slide-7">
            <div class="hd">SEVEN</div>
          </div>
          <div class="slide slide-8">
            <div class="hd">EIGHT</div>
          </div>
        
        </div>

      <div class="nav nav-right">
        <div class="ion-chevron-right carousel-arrow-icon-right"></div>
      </div>
    </div>
    
</div>
<!-- partial -->
  <!-- <script  src="./script.js"></script> -->
  <script>
    var carousel = document.querySelector('.carousel');
var carouselContent = document.querySelector('.carousel-content');
var slides = document.querySelectorAll('.slide');
var arrayOfSlides = Array.prototype.slice.call(slides);
var carouselDisplaying;
var screenSize;
setScreenSize();
var lengthOfSlide;

function addClone() {
   var lastSlide = carouselContent.lastElementChild.cloneNode(true);
   lastSlide.style.left = (-lengthOfSlide) + "px";
   carouselContent.insertBefore(lastSlide, carouselContent.firstChild);
}
// addClone();

function removeClone() {
  var firstSlide = carouselContent.firstElementChild;
  firstSlide.parentNode.removeChild(firstSlide);
}

function moveSlidesRight() {
  var slides = document.querySelectorAll('.slide');
  var slidesArray = Array.prototype.slice.call(slides);
  var width = 0;

  slidesArray.forEach(function(el, i){
    el.style.left = width + "px";
    width += lengthOfSlide;
  });
  addClone();
}
moveSlidesRight();

function moveSlidesLeft() {
  var slides = document.querySelectorAll('.slide');
  var slidesArray = Array.prototype.slice.call(slides);
  slidesArray = slidesArray.reverse();
  var maxWidth = (slidesArray.length - 1) * lengthOfSlide;

  slidesArray.forEach(function(el, i){
    maxWidth -= lengthOfSlide;
    el.style.left = maxWidth + "px";
  });
}

window.addEventListener('resize', setScreenSize);

function setScreenSize() {
  /*if ( window.innerWidth >= 500 ) {
    carouselDisplaying = 3;
  } else if ( window.innerWidth >= 300 ) {
    carouselDisplaying = 2;
  } else {
    carouselDisplaying = 1;
  }*/
  carouselDisplaying = 1;
  getScreenSize();
}

function getScreenSize() {
  var slides = document.querySelectorAll('.slide');
  var slidesArray = Array.prototype.slice.call(slides);
  lengthOfSlide = ( carousel.offsetWidth  / carouselDisplaying );
  var initialWidth = -lengthOfSlide;
  slidesArray.forEach(function(el) {
    el.style.width = lengthOfSlide + "px";
    el.style.left = initialWidth + "px";
    initialWidth += lengthOfSlide;
  });
}


var rightNav = document.querySelector('.nav-right');
rightNav.addEventListener('click', moveLeft);

var moving = true;
function moveRight() {
  if ( moving ) {
    moving = false;
    var lastSlide = carouselContent.lastElementChild;
    lastSlide.parentNode.removeChild(lastSlide);
    carouselContent.insertBefore(lastSlide, carouselContent.firstChild);
    removeClone();
    var firstSlide = carouselContent.firstElementChild;
    firstSlide.addEventListener('transitionend', activateAgain);
    moveSlidesRight();
  }
}

function activateAgain() {
  var firstSlide = carouselContent.firstElementChild;
  moving = true;
  firstSlide.removeEventListener('transitionend', activateAgain);
}

var leftNav = document.querySelector('.nav-left');
leftNav.addEventListener('click', moveRight);

// var moveLeftAgain = true;

function moveLeft() {
  if ( moving ) {
    moving = false;
    removeClone();
    var firstSlide = carouselContent.firstElementChild;
    firstSlide.addEventListener('transitionend', replaceToEnd);
    moveSlidesLeft();
  }
}

function replaceToEnd() {
  var firstSlide = carouselContent.firstElementChild;
  firstSlide.parentNode.removeChild(firstSlide);
  carouselContent.appendChild(firstSlide);
  firstSlide.style.left = ( (arrayOfSlides.length -1) * lengthOfSlide) + "px";
  addClone();
  moving = true;
  firstSlide.removeEventListener('transitionend', replaceToEnd);
}




carouselContent.addEventListener('mousedown', seeMovement);

var initialX;
var initialPos;
function seeMovement(e) {
  initialX = e.clientX;
  getInitialPos();
  carouselContent.addEventListener('mousemove', slightMove);
  document.addEventListener('mouseup', moveBasedOnMouse);
}

function slightMove(e) {
  if ( moving ) {
    var movingX = e.clientX;
    var difference = initialX - movingX;
    if ( Math.abs(difference) < (lengthOfSlide/4) ) {
      slightMoveSlides(difference);
    }  
  }
}

function getInitialPos() {
  var slides = document.querySelectorAll('.slide');
  var slidesArray = Array.prototype.slice.call(slides);
  initialPos = [];
  slidesArray.forEach(function(el){
    var left = Math.floor( parseInt( el.style.left.slice(0, -2 ) ) ); 
    initialPos.push( left );
  });
}

function slightMoveSlides(newX) {
  var slides = document.querySelectorAll('.slide');
  var slidesArray = Array.prototype.slice.call(slides);
  slidesArray.forEach(function(el, i){
    var oldLeft = initialPos[i];
    el.style.left = (oldLeft + newX) + "px";
  });
}

function moveBasedOnMouse(e) { 
  var finalX = e.clientX;
  if ( initialX - finalX > 0) {
    moveRight();
  } else if ( initialX - finalX < 0 ) {
    moveLeft();
  }
  document.removeEventListener('mouseup', moveBasedOnMouse);
  carouselContent.removeEventListener('mousemove', slightMove);
}
  </script>

</body>
</html>
